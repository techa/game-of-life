import{w as P,r as X}from"./index.a772b8b3.js";import{a1 as j}from"./scheduler.426d140d.js";const Y=P(void 0);function g(t,e){const{computePosition:a,autoUpdate:c,offset:m,shift:v,flip:d,arrow:w,size:h,autoPlacement:s,hide:l,inline:E}=j(Y),r={open:!1,autoUpdateCleanup:()=>{}},U=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let b;const f="https://www.skeleton.dev/utilities/popups";let n,L;function C(){n=document.querySelector(`[data-popup="${e.target}"]`)??document.createElement("div"),L=n.querySelector(".arrow")??document.createElement("div")}C();function $(){var i,p,k,I,M,_,q,Q;if(!n)throw new Error(`The data-popup="${e.target}" element was not found. ${f}`);if(!a)throw new Error(`Floating UI 'computePosition' not found for data-popup="${e.target}". ${f}`);if(!m)throw new Error(`Floating UI 'offset' not found for data-popup="${e.target}". ${f}`);if(!v)throw new Error(`Floating UI 'shift' not found for data-popup="${e.target}". ${f}`);if(!d)throw new Error(`Floating UI 'flip' not found for data-popup="${e.target}". ${f}`);if(!w)throw new Error(`Floating UI 'arrow' not found for data-popup="${e.target}". ${f}`);const o=[];h&&o.push(h((i=e.middleware)==null?void 0:i.size)),s&&o.push(s((p=e.middleware)==null?void 0:p.autoPlacement)),l&&o.push(l((k=e.middleware)==null?void 0:k.hide)),E&&o.push(E((I=e.middleware)==null?void 0:I.inline)),a(t,n,{placement:e.placement??"bottom",middleware:[m(((M=e.middleware)==null?void 0:M.offset)??8),v(((_=e.middleware)==null?void 0:_.shift)??{padding:8}),d((q=e.middleware)==null?void 0:q.flip),w(((Q=e.middleware)==null?void 0:Q.arrow)??{element:L||null}),...o]}).then(({x:V,y:W,placement:B,middlewareData:J})=>{if(Object.assign(n.style,{left:`${V}px`,top:`${W}px`}),L){const{x:T,y:z}=J.arrow,K={top:"bottom",right:"left",bottom:"top",left:"right"}[B.split("-")[0]];Object.assign(L.style,{left:T!=null?`${T}px`:"",top:z!=null?`${z}px`:"",right:"",bottom:"",[K]:"-4px"})}})}function y(){n&&(r.open=!0,e.state&&e.state({state:r.open}),$(),n.style.display="block",n.style.opacity="1",n.style.pointerEvents="auto",n.removeAttribute("inert"),r.autoUpdateCleanup=c(t,n,$),b=Array.from(n==null?void 0:n.querySelectorAll(U)))}function u(o){if(!n)return;const i=parseFloat(window.getComputedStyle(n).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{r.open=!1,e.state&&e.state({state:r.open}),n.style.opacity="0",n.setAttribute("inert",""),r.autoUpdateCleanup&&r.autoUpdateCleanup(),o&&o()},i)}function S(){r.open===!1?y():u()}function x(o){if(r.open===!1||t.contains(o.target))return;if(n&&n.contains(o.target)===!1){u();return}const i=e.closeQuery===void 0?"a[href], button":e.closeQuery;if(i==="")return;const p=n==null?void 0:n.querySelectorAll(i);p==null||p.forEach(k=>{k.contains(o.target)&&u()})}const D=o=>{if(r.open===!1)return;const i=o.key;if(i==="Escape"){o.preventDefault(),t.focus(),u();return}b=Array.from(n==null?void 0:n.querySelectorAll(U)),r.open&&document.activeElement===t&&(i==="ArrowDown"||i==="Tab")&&U.length>0&&b.length>0&&(o.preventDefault(),b[0].focus())};switch(e.event){case"click":t.addEventListener("click",S,!0),window.addEventListener("click",x,!0);break;case"hover":t.addEventListener("mouseover",y,!0),t.addEventListener("mouseleave",()=>u(),!0);break;case"focus-blur":t.addEventListener("focus",S,!0),t.addEventListener("blur",()=>u(),!0);break;case"focus-click":t.addEventListener("focus",y,!0),window.addEventListener("click",x,!0);break;default:throw new Error(`Event value of '${e.event}' is not supported. ${f}`)}return window.addEventListener("keydown",D,!0),$(),{update(o){u(()=>{e=o,$(),C()})},destroy(){t.removeEventListener("click",S,!0),t.removeEventListener("mouseover",y,!0),t.removeEventListener("mouseleave",()=>u(),!0),t.removeEventListener("focus",S,!0),t.removeEventListener("focus",y,!0),t.removeEventListener("blur",()=>u(),!0),window.removeEventListener("click",x,!0),window.removeEventListener("keydown",D,!0)}}}const A={};function O(t){return t==="local"?localStorage:sessionStorage}function F(t,e,a){const c=(a==null?void 0:a.serializer)??JSON,m=(a==null?void 0:a.storage)??"local";function v(d,w){O(m).setItem(d,c.stringify(w))}if(!A[t]){const d=P(e,s=>{const l=O(m).getItem(t);l&&s(c.parse(l));{const E=r=>{r.key===t&&s(r.newValue?c.parse(r.newValue):null)};return window.addEventListener("storage",E),()=>window.removeEventListener("storage",E)}}),{subscribe:w,set:h}=d;A[t]={set(s){v(t,s),h(s)},update(s){const l=s(j(d));v(t,l),h(l)},subscribe:w}}return A[t]}F("modeOsPrefers",!1);F("modeUserPrefers",void 0);F("modeCurrent",!1);const R="(prefers-reduced-motion: reduce)";function G(){return window.matchMedia(R).matches}X(G(),t=>{{const e=c=>{t(c.matches)},a=window.matchMedia(R);return a.addEventListener("change",e),()=>{a.removeEventListener("change",e)}}});export{g as p,Y as s};
